



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Official ROCK Documentation">
      
      
      
        <meta name="author" content="RockNSM">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>Suricata - RockNSM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#suricata" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="RockNSM" class="md-header-nav__button md-logo">
          
            <img src="../../img/rock.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              RockNSM
            </span>
            <span class="md-header-nav__topic">
              Suricata
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/rocknsm/rock-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    rocknsm/rock-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="RockNSM" class="md-nav__button md-logo">
      
        <img src="../../img/rock.png" width="48" height="48">
      
    </a>
    RockNSM
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/rocknsm/rock-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    rocknsm/rock-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/what_is_it/" title="What is ROCK" class="md-nav__link">
      What is ROCK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/backstory/" title="Backstory" class="md-nav__link">
      Backstory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/dataflow/" title="Data Flow" class="md-nav__link">
      Data Flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/requirements/" title="Requirements" class="md-nav__link">
      Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/media/" title="Media" class="md-nav__link">
      Media
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Configure
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Configure
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/rock-manager/" title="Rock Manager" class="md-nav__link">
      Rock Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/setup-tui/" title="Setup TUI" class="md-nav__link">
      Setup TUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/reference/" title="Config Reference" class="md-nav__link">
      Config Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Deploy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Deploy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/single-node/" title="Single Node" class="md-nav__link">
      Single Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/multi-node/" title="Multi Node" class="md-nav__link">
      Multi Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/initial-access/" title="Initial Access" class="md-nav__link">
      Initial Access
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/" title="Basic Operation" class="md-nav__link">
      Basic Operation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../zeek/" title="Zeek" class="md-nav__link">
      Zeek
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../stenographer/" title="Stenographer" class="md-nav__link">
      Stenographer
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Suricata
      </label>
    
    <a href="./" title="Suricata" class="md-nav__link md-nav__link--active">
      Suricata
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#service-management" title="Service Management" class="md-nav__link">
    Service Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notable-files-directories" title="Notable Files / Directories" class="md-nav__link">
    Notable Files / Directories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-rules" title="Updating Rules" class="md-nav__link">
    Updating Rules
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-feeds" title="Enabling Feeds" class="md-nav__link">
    Enabling Feeds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulating-individual-rules" title="Manipulating Individual Rules" class="md-nav__link">
    Manipulating Individual Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-rule-management" title="Local Rule Management" class="md-nav__link">
    Local Rule Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automating-it" title="Automating It" class="md-nav__link">
    Automating It
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fsf/" title="FSF" class="md-nav__link">
      FSF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../filebeat/" title="Filebeat" class="md-nav__link">
      Filebeat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logstash/" title="Logstash" class="md-nav__link">
      Logstash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../elasticsearch/" title="Elasticsearch" class="md-nav__link">
      Elasticsearch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../kibana/" title="Kibana" class="md-nav__link">
      Kibana
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docket/" title="Docket" class="md-nav__link">
      Docket
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/latest/" title="Latest Release" class="md-nav__link">
      Latest Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/tutorials/" title="Tutorials and Videos" class="md-nav__link">
      Tutorials and Videos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/contribution/" title="Contribution" class="md-nav__link">
      Contribution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/support/" title="Commercial Support" class="md-nav__link">
      Commercial Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#service-management" title="Service Management" class="md-nav__link">
    Service Management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notable-files-directories" title="Notable Files / Directories" class="md-nav__link">
    Notable Files / Directories
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-rules" title="Updating Rules" class="md-nav__link">
    Updating Rules
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enabling-feeds" title="Enabling Feeds" class="md-nav__link">
    Enabling Feeds
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulating-individual-rules" title="Manipulating Individual Rules" class="md-nav__link">
    Manipulating Individual Rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-rule-management" title="Local Rule Management" class="md-nav__link">
    Local Rule Management
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automating-it" title="Automating It" class="md-nav__link">
    Automating It
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rocknsm/rock-docs/edit/master/docs/services/suricata.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="suricata">Suricata<a class="headerlink" href="#suricata" title="Permanent link">&para;</a></h1>
<p>Intrusion Detection Systems (IDS) are a great way to quickly alert on known
bad. Alerts are triggered when a packet matches a defined pattern or
<em><strong>signature</strong></em>.  </p>
<p><a href="https://suricata-ids.org/">Suricata</a> is the IDS / Alerting tool of choice for
RockNSM. It provides a lot of features not available in our previous option.
Most importantly, Suricata offers:  </p>
<ul>
<li>multi-threading capability</li>
<li>active development community and</li>
<li>frequent feature additions &amp; project momentum</li>
</ul>
<h2 id="service-management">Service Management<a class="headerlink" href="#service-management" title="Permanent link">&para;</a></h2>
<p>Suricata is deployed as a systemd unit called <code>suricata.service</code>. Normal systemd
procedures apply here. It can also be managed using the <code>rockctl</code> command using
the same syntax:  </p>
<div class="codehilite"><pre><span></span>sudo systemctl start suricata
sudo systemctl status suricata
sudo systemctl stop suricata
sudo systemctl restart suricata
</pre></div>


<p>The default ROCK configuration has the Suricata service enabled on startup.  </p>
<h2 id="notable-files-directories">Notable Files / Directories<a class="headerlink" href="#notable-files-directories" title="Permanent link">&para;</a></h2>
<p><code>/etc/suricata/</code> - main configuration path<br />
<code>/var/lib/suricata/</code> - primary rule path</p>
<h2 id="updating-rules">Updating Rules<a class="headerlink" href="#updating-rules" title="Permanent link">&para;</a></h2>
<p>The newest versions of Suricata come with the <code>suricata-update</code> command to
manange and update rulesets. The official documentation is found
<a href="https://suricata.readthedocs.io/en/suricata-4.1.2/rule-management/suricata-update.html">here</a>.  </p>
<h3 id="enabling-feeds">Enabling Feeds<a class="headerlink" href="#enabling-feeds" title="Permanent link">&para;</a></h3>
<p>Suricata Update is a Python module and is automatically bundled with Suricata
starting with version 4.1. While it does have documentation, it’s helpful to
have a practical example. One of the awesome features with Suricata Update is
it comes with a pre-configured list of signature feeds out of the box, both
free and paid. It makes it very simple to enabled paid feeds.</p>
<p>To view the list of available feeds, login to your RockNSM system and run:</p>
<p>$ <code>sudo suricata-update list-sources</code>  </p>
<p>This will return something similar to the following:</p>
<div class="codehilite"><pre><span></span><span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">oisf/trafficid</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">OISF</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Suricata Traffic ID ruleset</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MIT</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">et/open</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Proofpoint</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Emerging Threats Open Ruleset</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MIT</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scwx/security</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Secureworks</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Secureworks suricata-security ruleset.</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Commercial</span>
  <span class="l l-Scalar l-Scalar-Plain">Parameters</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">secret-code</span>
  <span class="l l-Scalar l-Scalar-Plain">Subscription</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.secureworks.com/contact/ (Please reference CTU Countermeasures)</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scwx/malware</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Secureworks</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Secureworks suricata-malware ruleset.</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Commercial</span>
  <span class="l l-Scalar l-Scalar-Plain">Parameters</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">secret-code</span>
  <span class="l l-Scalar l-Scalar-Plain">Subscription</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.secureworks.com/contact/ (Please reference CTU Countermeasures)</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">et/pro</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Proofpoint</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Emerging Threats Pro Ruleset</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Commercial</span>
  <span class="l l-Scalar l-Scalar-Plain">Replaces</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">et/open</span>
  <span class="l l-Scalar l-Scalar-Plain">Parameters</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">secret-code</span>
  <span class="l l-Scalar l-Scalar-Plain">Subscription</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">https://www.proofpoint.com/us/threat-insight/et-pro-ruleset</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ptresearch/attackdetection</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Positive Technologies</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Positive Technologies Attack Detection Team ruleset</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Custom</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sslbl/ssl-fp-blacklist</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Abuse.ch</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Abuse.ch SSL Blacklist</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Non-Commercial</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">tgreen/hunting</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tgreen</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Heuristic ruleset for hunting. Focus on anomaly detection and showcasing latest engine features, not performance.</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">GPLv3</span>
<span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">etnetera/aggressive</span>
  <span class="l l-Scalar l-Scalar-Plain">Vendor</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Etnetera a.s.</span>
  <span class="l l-Scalar l-Scalar-Plain">Summary</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">Etnetera aggressive IP blacklist</span>
  <span class="l l-Scalar l-Scalar-Plain">License</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MIT</span>
</pre></div>


<p>Without any additional configuration, suricata-update will automatically pull in the et/open ruleset. You can disable this ruleset if you desire. Now, if you are a subscriber to et/pro or another included ruleset that requires an access code (sometimes referred to as an “oinkcode” in Snort parlance), you can pass that on the command line or suricata-update will prompt you.</p>
<p><code>suricata-update enable-source et/pro secret-code=xxxxxxxxxxxxxxxx</code>  </p>
<h3 id="manipulating-individual-rules">Manipulating Individual Rules<a class="headerlink" href="#manipulating-individual-rules" title="Permanent link">&para;</a></h3>
<p>Often times, we want to turn off specific rules — maybe they’re too noisy for our network, or corporate policy doesn’t concern with browser extensions on BYOD systems. Again, <code>suricata-update</code> makes our life easy on our RockNSM sensors.  </p>
<div class="codehilite"><pre><span></span><span class="c1"># Elevate to a root shell and go to Suricata dir</span>
sudo -s
<span class="nb">cd</span> /etc/suricata

<span class="c1"># Generate default suricata-update configs</span>
suricata-update --dump-sample-configs
</pre></div>


<p>This command will generate six default files:</p>
<ol>
<li><code>update.yaml</code> - the suricata-update config file</li>
<li><code>enable.conf</code> - config to enable rules that are usually disabled</li>
<li><code>disable.conf</code> - config to disable rules that are usually enabled</li>
<li><code>modify.conf</code> - use regex to modify rules</li>
<li><code>drop.conf</code> - change rules from alert to drop, not used in RockNSM</li>
<li><code>threshold.in</code> - set thresholds to limit too-frequent firing of given alerts</li>
</ol>
<p>To disable the noisy rule above, we just need to specify its signature ID (e.g. alert.signature_id). Open disable.conf and add the following line:</p>
<div class="codehilite"><pre><span></span># Disable invalid timestamp rule (sid: 2210044)
    2210044
</pre></div>


<p>We could alternatively specify the rule using regular expressions:</p>
<div class="codehilite"><pre><span></span># Disable all SURICATA STREAM alert rules
    re:^alert.*SURICATA STREAM
</pre></div>


<p>Next, just run <code>suricata-update</code>. Note, you want to ensure that <code>suricata-update</code> runs as the same user as the <code>suricata</code> service. On RockNSM, this is the <code>suricata</code> system user. This should really only be necessary the first time <code>suricata-update</code> is run, to ensure that when Suricata runs it can read the rules. Near the end of the run, you’ll see a summary how many rules were loaded, disabled, enabled, modified, dropped, and some other stats.</p>
<div class="codehilite"><pre><span></span>sudo -u suricata -g suricata suricata-update
...
27/2/2019 -- 00:08:39 - &lt;Info&gt; -- Loaded 29733 rules.
27/2/2019 -- 00:08:40 - &lt;Info&gt; -- Disabled 68 rules.
27/2/2019 -- 00:08:40 - &lt;Info&gt; -- Enabled 0 rules.
27/2/2019 -- 00:08:40 - &lt;Info&gt; -- Modified 0 rules.
27/2/2019 -- 00:08:40 - &lt;Info&gt; -- Dropped 0 rules.
27/2/2019 -- 00:08:41 - &lt;Info&gt; -- Enabled 188 rules for flowbit dependencies.
27/2/2019 -- 00:08:41 - &lt;Info&gt; -- Backing up current rules.
27/2/2019 -- 00:08:45 - &lt;Info&gt; -- Writing rules to /var/lib/suricata/rules/suricata.rules: total: 29733; enabled: 22272; added: 4; removed 19; modified: 1215
</pre></div>


<p>You can sanity check that it worked by checking the output for the signature you disabled with grep. You could also search using the same regex as before! If you want to match the regex pattern, be sure to search for a line starting with a # followed by a single space, as this is how the rule is commented out. If the disable configuration worked, you’ll see the rule, but it will be commented out.</p>
<div class="codehilite"><pre><span></span>sudo grep <span class="m">2210044</span> /var/lib/suricata/rules/suricata.rules
<span class="c1"># alert tcp any any -&gt; any any (msg:&quot;SURICATA STREAM Packet with invalid timestamp&quot;; stream-event:pkt_invalid_timestamp; classtype:protocol-command-decode; sid:2210044; rev:2;)</span>
</pre></div>


<p>To check for a regex you could do this.</p>
<div class="codehilite"><pre><span></span>sudo grep &#39;^# alert.*SURICATA STREAM&#39;
/var/lib/suricata/rules/suricata.rules
...
(a whole bunch of rules match this)
</pre></div>


<h3 id="local-rule-management">Local Rule Management<a class="headerlink" href="#local-rule-management" title="Permanent link">&para;</a></h3>
<p>Suricata Update lets you manage local rules using the same process above. In the <code>update.yaml</code> it defaults to loading all rules in the <code>/etc/suricata/rules</code> directory. You could add some local site-specific directory, as well. Suricata Update will parse each of these rules and apply the same operations that you configured, as detailed above.</p>
<h3 id="automating-it">Automating It<a class="headerlink" href="#automating-it" title="Permanent link">&para;</a></h3>
<p>RockNSM automatically will run your suricata-update process once per day. This is done using crond in <code>/etc/cron.d/rocknsm_suricata-update</code> every day at noon UTC (which is the default and recommended RockNSM sensor time zone).  </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../stenographer/" title="Stenographer" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Stenographer
              </span>
            </div>
          </a>
        
        
          <a href="../fsf/" title="FSF" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                FSF
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 RockNSM
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rocknsm" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/rocknsm" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>