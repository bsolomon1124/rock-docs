



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Official ROCK Documentation">
      
      
      
        <meta name="author" content="RockNSM">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>Support - RockNSM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#support-guide" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="RockNSM" class="md-header-nav__button md-logo">
          
            <img src="../../img/rock.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              RockNSM
            </span>
            <span class="md-header-nav__topic">
              Support
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/rocknsm/rock-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    rocknsm/rock-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="RockNSM" class="md-nav__button md-logo">
      
        <img src="../../img/rock.png" width="48" height="48">
      
    </a>
    RockNSM
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/rocknsm/rock-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    rocknsm/rock-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/what_is_it/" title="What is ROCK" class="md-nav__link">
      What is ROCK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/backstory/" title="Backstory" class="md-nav__link">
      Backstory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/dataflow/" title="Data Flow" class="md-nav__link">
      Data Flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/requirements/" title="Requirements" class="md-nav__link">
      Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/media/" title="Media" class="md-nav__link">
      Media
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Configure
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Configure
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/rock-manager/" title="Rock Manager" class="md-nav__link">
      Rock Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/setup-tui/" title="Setup TUI" class="md-nav__link">
      Setup TUI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configure/reference/" title="Config Reference" class="md-nav__link">
      Config Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Deploy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Deploy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/terminology/" title="Terminology" class="md-nav__link">
      Terminology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/single-node/" title="Single Node" class="md-nav__link">
      Single Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/multi-node/" title="Multi Node" class="md-nav__link">
      Multi Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/initial-access/" title="Initial Access" class="md-nav__link">
      Initial Access
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Basic Operation" class="md-nav__link">
      Basic Operation
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Support
      </label>
    
    <a href="./" title="Support" class="md-nav__link md-nav__link--active">
      Support
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#suricata-service-fails-to-start" title="Suricata Service Fails to Start" class="md-nav__link">
    Suricata Service Fails to Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autodetect-assumptions" title="Autodetect Assumptions" class="md-nav__link">
    Autodetect Assumptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-script" title="Deployment Script" class="md-nav__link">
    Deployment Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-timestamps" title="Log Timestamps" class="md-nav__link">
    Log Timestamps
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/zeek/" title="Zeek" class="md-nav__link">
      Zeek
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/stenographer/" title="Stenographer" class="md-nav__link">
      Stenographer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/suricata/" title="Suricata" class="md-nav__link">
      Suricata
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/fsf/" title="FSF" class="md-nav__link">
      FSF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/filebeat/" title="Filebeat" class="md-nav__link">
      Filebeat
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/logstash/" title="Logstash" class="md-nav__link">
      Logstash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/elasticsearch/" title="Elasticsearch" class="md-nav__link">
      Elasticsearch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/kibana/" title="Kibana" class="md-nav__link">
      Kibana
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../services/docket/" title="Docket" class="md-nav__link">
      Docket
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/latest/" title="Latest Release" class="md-nav__link">
      Latest Release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/tutorials/" title="Tutorials and Videos" class="md-nav__link">
      Tutorials and Videos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/contribution/" title="Contribution" class="md-nav__link">
      Contribution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../reference/support/" title="Commercial Support" class="md-nav__link">
      Commercial Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#suricata-service-fails-to-start" title="Suricata Service Fails to Start" class="md-nav__link">
    Suricata Service Fails to Start
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#autodetect-assumptions" title="Autodetect Assumptions" class="md-nav__link">
    Autodetect Assumptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-script" title="Deployment Script" class="md-nav__link">
    Deployment Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#log-timestamps" title="Log Timestamps" class="md-nav__link">
    Log Timestamps
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rocknsm/rock-docs/edit/master/docs/usage/support.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="support-guide">Support Guide<a class="headerlink" href="#support-guide" title="Permanent link">&para;</a></h1>
<p>This section aims to smooth out the most frequent issues new users will run into.</p>
<h3 id="suricata-service-fails-to-start">Suricata Service Fails to Start<a class="headerlink" href="#suricata-service-fails-to-start" title="Permanent link">&para;</a></h3>
<p>This can occur after successful installation of the ROCK sensor.</p>
<p>To identify if this is an issue, run <code>sudo rockctl status</code> and you'll see</p>
<div class="codehilite"><pre><span></span>SURICATA:
    Active: failed (Result: exit-code) since Mon 2020-01-06 01:00:57 UTC; 40min ago
</pre></div>


<p>To validate, run run <code>sudo journalctl -u suricata</code> and look for the <code>MemoryDenyWriteExecute</code>, meaning Suricata is using more RAM than is available. We need to tamp 'er down.</p>
<div class="codehilite"><pre><span></span>sudo journalctl -u suricata
-- Logs begin at Sun 2020-01-05 22:14:04 UTC, end at Mon 2020-01-06 01:42:58 UTC. --
Jan 05 22:57:54 rock-1.rock.lan systemd[1]: [/usr/lib/systemd/system/suricata.service:17] Unknown lvalue &#39;MemoryDenyWriteExecute&#39; in section &#39;Service&#39;
Jan 05 22:57:54 rock-1.rock.lan systemd[1]: [/usr/lib/systemd/system/suricata.service:18] Unknown lvalue &#39;LockPersonality&#39; in section &#39;Service&#39;
Jan 05 22:57:54 rock-1.rock.lan systemd[1]: [/usr/lib/systemd/system/suricata.service:19] Unknown lvalue &#39;ProtectControlGroups&#39; in section &#39;Service&#39;
Jan 05 22:57:54 rock-1.rock.lan systemd[1]: [/usr/lib/systemd/system/suricata.service:20] Unknown lvalue &#39;ProtectKernelModules&#39; in section &#39;Service&#39;
Jan 05 22:58:05 rock-1.rock.lan systemd[1]: Started Suricata Intrusion Detection Service.
</pre></div>


<p>To fix this issue, identify the non-management interface that is connected by using <code>ip link</code> and looking for the interface that has <code>BROADCAST</code> and <code>state UP</code>. In this example, <code>ens192f1</code> is <code>UP</code> (<code>ens193</code> is the management interface).</p>
<div class="codehilite"><pre><span></span>ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: ens193: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether 00:50:56:9f:c1:4e brd ff:ff:ff:ff:ff:ff
3: ens192f0: &lt;NO-CARRIER,BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether f8:f2:1e:34:0f:40 brd ff:ff:ff:ff:ff:ff
4: ens192f1: &lt;BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DEFAULT group default qlen 1000
    link/ether f8:f2:1e:34:0f:41 brd ff:ff:ff:ff:ff:ff
5: ens256f0: &lt;NO-CARRIER,BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether f8:f2:1e:34:0a:80 brd ff:ff:ff:ff:ff:ff
6: ens256f1: &lt;NO-CARRIER,BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether f8:f2:1e:34:0a:81 brd ff:ff:ff:ff:ff:ff
</pre></div>


<p><code>sudo vi /etc/suricata/rocknsm-overrides.yaml</code> and comment out everything under the <code>af-packet</code> heading with the exception of the connected non-management interface and setting the <code>threads</code> from <code>auto</code> to <code>12</code> (in our example, but you may want to use a different number based on your environment). Example:</p>
<div class="codehilite"><pre><span></span>af-packet:
#  - interface: ens192f0
#    #threads: auto
#    cluster-id: 99
#    cluster-type: cluster_flow
#    defrag: true
#    use-mmap: true
#    mmap-locked: true
#    #rollover: true
#    tpacket-v3: true
#    use-emergency-flush: true
  - interface: ens192f1
    threads: 12
    cluster-id: 98
    cluster-type: cluster_flow
    defrag: true
    use-mmap: true
    mmap-locked: true
    #rollover: true
    tpacket-v3: true
    use-emergency-flush: true
#  - interface: ens256f1
#    #threads: auto
#    cluster-id: 97
#    cluster-type: cluster_flow
#    defrag: true
#    use-mmap: true
#    mmap-locked: true
#    #rollover: true
#    tpacket-v3: true
#    use-emergency-flush: true
#  - interface: ens256f0
#    #threads: auto
#    cluster-id: 96
#    cluster-type: cluster_flow
#    defrag: true
#    use-mmap: true
#    mmap-locked: true
#    #rollover: true
#    tpacket-v3: true
#    use-emergency-flush: true
</pre></div>


<p>Afterwards, restart <code>sudo rockctl status</code> and verify everything is started:</p>
<div class="codehilite"><pre><span></span>SURICATA:
    Active: active (running) since Mon 2020-01-06 01:55:37 UTC; 1min 28s ago
</pre></div>


<h2 id="autodetect-assumptions">Autodetect Assumptions<a class="headerlink" href="#autodetect-assumptions" title="Permanent link">&para;</a></h2>
<p>When writing the scripts to generate default values, we had to make some
assumptions. The defaults are generated according to these assumptions and
should generally work if your sensor aligns with them. That said, these
assumptions will give you a working sensor, but may need some love for higher
performance. If you cannot meet these assumptions, look at the indicated
configuration variables in <code>/etc/rocknsm/config.yml</code> for workaround approaches
(with impact on performance).  </p>
<blockquote>
<p>TIP: We assume that any interface that does not have a default route will be used for collection. Each sensor application will be configured accordingly.</p>
</blockquote>
<p><strong>WARNING</strong>: This so far has been the number one problem with a fresh install
for beta testers!! Check your interface configuration!!</p>
<ul>
<li>
<p>Two Network Interfaces:</p>
<ul>
<li>a management interface with a default route</li>
<li>an interface without a default route (defined by <code>rock_monifs</code>)</li>
</ul>
</li>
<li>
<p>You have mounted your largest storage volume(s) under <code>/data/</code>
(defined by <code>rock_data_dir</code>)</p>
</li>
<li>
<p>Your hostname (FQDN) is defined in the <code>playbooks/inventory/all-in-one.ini</code> file</p>
</li>
<li>
<p>You allow management via SSH from any network (defined by <code>rock_mgmt_nets</code>)</p>
</li>
<li>
<p>You wish to use Zeek, Suricata, Stenographer (disabled by default) and the
whole data pipeline. (See <code>with_*</code> options)</p>
</li>
<li>
<p>If installed via ISO, you will perform an offline install, else we assume
online (defined by <code>rock_online_install</code>)</p>
</li>
<li>
<p>Zeek will use half of your CPU resources, up to 8 CPUs</p>
</li>
</ul>
<p>We will continue to add more support information as the userbase grows.</p>
<h2 id="deployment-script">Deployment Script<a class="headerlink" href="#deployment-script" title="Permanent link">&para;</a></h2>
<p>If you find the deployment is failing, the script can be run with very verbose
output.  This example will write the output to a file for review:  </p>
<p><code>DEBUG=1 ./deploy_rock.sh | tee /tmp/deploy_rock.log</code></p>
<h2 id="log-timestamps">Log Timestamps<a class="headerlink" href="#log-timestamps" title="Permanent link">&para;</a></h2>
<p>UTC is generally preferred for logging data as the timestamps from anywhere in the world will have a proper order without calculating offsets. That said, Kibana will present the zeek logs according to your timezone (as set in the browser). The logs themselves (i.e. in /data/bro/logs/) log in epoch time and will be written in UTC regardless of the system timezone.</p>
<p>Zeek includes a utility for parsing these on the command line called <code>bro-cut</code>. It can be used to print human-readable timestamps in either the local sensor timezone or UTC. You can also give it a custom format string to specify what you'd like displayed.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../" title="Basic Operation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Basic Operation
              </span>
            </div>
          </a>
        
        
          <a href="../../services/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 RockNSM
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/rocknsm" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/rocknsm" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>